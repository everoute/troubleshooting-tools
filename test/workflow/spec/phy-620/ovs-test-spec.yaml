# OVS Test Specification Configuration
# File: test/workflow/spec/ovs-test-spec.yaml
# Description: Parameter specification for OVS eBPF testing

metadata:
  name: "OVS Test Specification"
  description: "Open vSwitch eBPF testing parameter specification"
  version: "3.0"

# 环境变量定义
variables:
  ovs:
    LOCAL_IP: "192.168.77.253"
    REMOTE_IP: "192.168.77.83"

# 测试矩阵定义
test_matrix:
  ovs:
    duration: 10
    tools:
      # ovs_upcall_latency_summary.py - 支持协议和方向
      - dir: ""
        script: "ovs_upcall_latency_summary.py"
        template: "sudo python3 {path} --src-ip {SRC_IP} --dst-ip {DST_IP} --protocol {protocol}"
        parameters:
          protocol: ["tcp", "udp", "icmp"]

      # ovs_userspace_megaflow.py - 支持协议和方向
      - dir: ""
        script: "ovs_userspace_megaflow.py"
        template: "sudo python3 {path} --src-ip {SRC_IP} --dst-ip {DST_IP} --protocol {protocol}"
        parameters:
          protocol: ["tcp", "udp", "icmp"]

      # ovs-kernel-module-drop-monitor.py - 支持协议和方向
      - dir: ""
        script: "ovs-kernel-module-drop-monitor.py"
        template: "sudo python3 {path} --src-ip {SRC_IP} --dst-ip {DST_IP} --protocol {protocol}"
        parameters:
          protocol: ["tcp", "udp", "icmp"]

    directions:
      rx:
        SRC_IP: "{REMOTE_IP}"
        DST_IP: "{LOCAL_IP}"
      tx:
        SRC_IP: "{LOCAL_IP}"
        DST_IP: "{REMOTE_IP}"

defaults:
  duration: 10
  use_sudo: true